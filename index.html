<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Solo Leveling</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="no-ui">
  <!-- ===== AUTH ===== -->
  <div id="auth-overlay" class="auth-overlay">
    <div class="auth-card has-runes">
      <h2 class="auth-title">Crea tu cuenta</h2>
      <div class="tabs" role="tablist">
        <button id="tabRegister" class="tab active" role="tab" aria-selected="true">Crear cuenta</button>
        <button id="tabLogin" class="tab" role="tab" aria-selected="false">Entrar</button>
      </div>

      <!-- REGISTRO con NOMBRE DE USUARIO -->
      <form id="formRegister" class="auth-form" autocomplete="off">
        <label>Nombre de usuario</label>
        <input id="regUser" type="text" placeholder="Ej. ShadowHunter" minlength="3" maxlength="20" required />
        <label>Correo</label>
        <input id="regEmail" type="email" placeholder="tu@correo.com" required />
        <label>Contrase√±a</label>
        <input id="regPass" type="password" placeholder="M√≠nimo 6 caracteres" minlength="6" required />
        <button type="submit" class="btn wfull" id="btnDoRegister">Crear cuenta</button>
        <div id="regMsg" class="muted"></div>
      </form>

      <!-- LOGIN -->
      <form id="formLogin" class="auth-form hidden" autocomplete="off">
        <label>Correo</label>
        <input id="loginEmail" type="email" placeholder="tu@correo.com" required />
        <label>Contrase√±a</label>
        <input id="loginPass" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required />
        <button type="submit" class="btn wfull" id="btnDoLogin">Entrar</button>
        <button type="button" id="btnReset" class="btn ghost wfull">¬øOlvidaste tu contrase√±a?</button>
        <div id="authMsg" class="muted"></div>
      </form>
    </div>
  </div>

  <!-- ===== INTRO (1 sola vez) ===== -->
  <div id="alarm-overlay" class="alarm-overlay hidden" aria-hidden="true">
    <div class="alarm-window has-runes" role="dialog" aria-modal="true" aria-labelledby="alarm-title" aria-describedby="alarm-text">
      <header class="alarm-header">
        <span class="alarm-badge">i</span>
        <h2 id="alarm-title" class="alarm-title">ALARMA</h2>
      </header>
      <div class="alarm-body">
        <div id="alarm-text" class="alarm-text"></div>
      </div>
      <button id="alarm-accept" class="btn pill">Aceptar</button>
    </div>
  </div>

  <!-- ===== TOPBAR ===== -->
  <header class="topbar hidden" id="topbar">
    <button id="menuBtn" class="icon-ghost" aria-label="Abrir men√∫" title="Men√∫">
      <svg viewBox="0 0 24 24" width="22" height="22"><path fill="currentColor" d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </button>
    <div class="top-spacer"></div>
    <button id="editTopBtn" class="icon-ghost" aria-label="Editar perfil" title="Editar perfil">‚úé</button>
    <input id="hiddenFile" type="file" accept="image/*" class="hidden" />
  </header>

  <!-- ===== MEN√ö LATERAL ===== -->
  <aside id="sideMenu" class="side-menu" aria-hidden="true">
    <div class="side-header">
      <div class="brand">Solo Leveling</div>
      <button id="closeSide" class="icon-ghost" aria-label="Cerrar men√∫">‚úñ</button>
    </div>
    <nav class="side-nav">
      <button class="side-link active" data-view="home">üè† Quests</button>
      <button class="side-link" data-view="friends">üë• Amigos</button>
      <button class="side-link" data-view="profile">üë§ Perfil</button>
      <button id="btnSignOut" class="side-link danger">‚éã Cerrar sesi√≥n</button>
    </nav>
  </aside>
  <div id="sideOverlay" class="side-overlay" hidden></div>

  <!-- ===== CONTENIDO ===== -->
  <main id="app" class="container hidden">
    <!-- HOME -->
    <section id="homeView" class="view current">
      <section class="card training-card has-runes">
        <div class="training-left">
          <div class="dots"><span></span><span></span><span></span></div>
          <div class="titles">
            <div class="t1">Daily Training</div>
            <div class="t2"><span id="pendingCount">4</span> ejercicios restantes</div>
          </div>
        </div>
        <div class="training-right">
          <div class="progress-ring">
            <svg viewBox="0 0 36 36">
              <path class="bg" d="M18 2a16 16 0 1 1 0 32a16 16 0 1 1 0-32"/>
              <path id="ring" class="fg" d="M18 2a16 16 0 1 1 0 32a16 16 0 1 1 0-32"/>
            </svg>
            <div id="progressText" class="ring-text">0%</div>
          </div>
        </div>
      </section>

      <section class="panel quest-panel has-runes">
        <div class="panel-head">
          <span class="info-ico">i</span>
          <h3>DAILY QUEST</h3>
        </div>
        <p class="quest-desc">[Entrenamiento para volverte un gran guerrero.]</p>
        <h4 class="subtitle">OBJETIVOS</h4>

        <ul id="questsList" class="q-list">
          <li class="q-item" data-id="flexiones" data-max="100">
            <span class="q-name">Flexiones</span><span class="q-progress">[0/100]</span>
            <label class="q-check"><input type="checkbox" class="q-toggle"/><span></span></label>
          </li>
          <li class="q-item" data-id="sentadillas" data-max="100">
            <span class="q-name">Sentadillas</span><span class="q-progress">[0/100]</span>
            <label class="q-check"><input type="checkbox" class="q-toggle"/><span></span></label>
          </li>
          <li class="q-item" data-id="abdominales1" data-max="100">
            <span class="q-name">Abdominales</span><span class="q-progress">[0/100]</span>
            <label class="q-check"><input type="checkbox" class="q-toggle"/><span></span></label>
          </li>
          <li class="q-item" data-id="correr" data-max="10" data-unit="km">
            <span class="q-name">Correr</span><span class="q-progress">[0/10km]</span>
            <label class="q-check"><input type="checkbox" class="q-toggle"/><span></span></label>
          </li>
        </ul>

        <p class="alert">¬°ATENCI√ìN! ‚Äî No completar la quest en el tiempo impartido ocasionar√° una penalizaci√≥n.</p>

        <div class="timer-block">
          <div class="timer-ico">‚è±</div>
          <div id="dailyCountdown" class="timer">00:00:00</div>
        </div>
      </section>
    </section>

    <!-- AMIGOS: por NOMBRE DE USUARIO -->
    <section id="friendsView" class="view hidden">
      <section class="panel friends-panel has-runes">
        <h3>Amigos</h3>
        <form id="addFriendForm" class="add-friend-form" autocomplete="off">
          <input id="friendUsername" type="text" placeholder="Nombre de usuario del amigo" required />
          <button class="btn" type="submit">Agregar</button>
          <span id="friendMsg" class="muted"></span>
        </form>
        <div id="friendsList" class="friends-list"></div>
      </section>
    </section>

    <!-- PERFIL (propio) -->
    <section id="profileView" class="view hidden">
      <section class="panel profile-panel has-runes">
        <div class="profile-card has-runes" id="selfProfileCard">
          <div class="pc-header">
            <div class="pc-frame"><img id="pcAvatar" alt="Avatar"></div>
          </div>

          <h2 id="pcName" class="pc-name">GUERRERO123</h2>

          <div class="level-row">
            <div class="pill left">NIVEL <span id="pcLevel">1</span></div>
            <div class="pill right"><span id="pcXp">0</span>/<span id="pcXpMax">1000</span></div>
          </div>

          <div class="rank-row">
            <div class="rank-line"></div>
            <div class="rank-pill">RANGO <span id="pcRank">E</span></div>
            <div class="rank-line"></div>
          </div>

          <div class="section-box">
            <div class="section-title">LOGROS</div>
            <div class="badges">
              <div class="badge b1"></div><div class="badge b2"></div>
              <div class="badge b3"></div><div class="badge b4"></div>
            </div>
          </div>

          <div class="section-title spaced">ESTAD√çSTICAS</div>
          <div class="stats">
            <div class="stat">
              <svg viewBox="0 0 36 36"><path class="sg" d="M18 2a16 16 0 1 1 0 32a16 16 0 1 1 0-32"/><path id="stF" class="sf" d="M18 2a16 16 0 1 1 0 32a16 16 0 1 1 0-32"/></svg>
              <div class="sv"><span id="stFuerza">85</span></div><div class="sc">FUERZA</div>
            </div>
            <div class="stat">
              <svg viewBox="0 0 36 36"><path class="sg" d="M18 2a16 16 0 1 1 0 32a16 16 0 1 1 0-32"/><path id="stR" class="sf" d="M18 2a16 16 0 1 1 0 32a16 16 0 1 1 0-32"/></svg>
              <div class="sv"><span id="stRes">72</span></div><div class="sc">RESISTENCIA</div>
            </div>
            <div class="stat">
              <svg viewBox="0 0 36 36"><path class="sg" d="M18 2a16 16 0 1 1 0 32a16 16 0 1 1 0-32"/><path id="stA" class="sf" d="M18 2a16 16 0 1 1 0 32a16 16 0 1 1 0-32"/></svg>
              <div class="sv"><span id="stAgi">60</span></div><div class="sc">AGILIDAD</div>
            </div>
          </div>
        </div>
      </section>
    </section>

    <!-- PERFIL P√öBLICO -->
    <section id="publicProfileView" class="view hidden">
      <section class="panel has-runes">
        <button id="ppBack" class="btn ghost small">‚Üê Volver</button>
        <div class="profile-card has-runes" id="friendProfileCard"></div>
      </section>
    </section>
  </main>

  <!-- ===== MODAL: Elegir nombre de usuario ===== -->
  <div id="usernameModal" class="uname-overlay hidden" aria-hidden="true">
    <div class="uname-card has-runes" role="dialog" aria-modal="true" aria-labelledby="unameTitle" aria-describedby="unameDesc">
      <h2 id="unameTitle">Elige tu nombre de usuario</h2>
      <p id="unameDesc" class="uname-desc">Tu @usuario ser√° √∫nico. Solo letras, n√∫meros o guiones bajos (3‚Äì20).</p>

      <form id="unameForm" class="uname-form" autocomplete="off">
        <label for="unameInput">@usuario</label>
        <input id="unameInput" type="text" placeholder="Ej. ShadowHunter" minlength="3" maxlength="20" required />
        <button id="unameSave" class="btn wfull" type="submit">Guardar</button>
        <div id="unameMsg" class="muted"></div>
      </form>

      <p class="uname-note">* No podr√°s continuar sin elegir un nombre v√°lido y disponible.</p>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth-compat.js"></script>

  <script src="app.js"></script>
</body>
</html>
